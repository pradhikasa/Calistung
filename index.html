<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ayo Belajar: Gambar Sempurna!</title>
    <style>
        :root {
            --primary: #FF6B6B;
            --secondary: #4ECDC4;
            --accent: #FFE66D;
            --dark: #292F36;
            --light: #F7FFF7;
            /* Menggunakan font yang mendukung Emoji dengan baik */
            --font-main: 'Fredoka One', 'Comic Sans MS', 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', sans-serif; 
            --font-arabic: 'Traditional Arabic', 'Amiri', 'Arial', sans-serif;
        }

        * {
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: var(--font-main);
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: var(--dark);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }

        /* --- BACKGROUND ANIMASI --- */
        .bg-shape {
            position: absolute;
            border-radius: 50%;
            opacity: 0.3;
            animation: floatBg 20s infinite linear;
            z-index: 0;
        }
        .shape-1 { width: 200px; height: 200px; background: #FF9FF3; top: -50px; left: -50px; animation-duration: 25s; }
        .shape-2 { width: 300px; height: 300px; background: #FECFEF; bottom: -50px; right: -50px; animation-duration: 30s; }
        .shape-3 { width: 150px; height: 150px; background: #E0F7FA; top: 40%; left: 20%; animation-duration: 22s; }

        @keyframes floatBg {
            0% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(30px, -50px) rotate(120deg); }
            66% { transform: translate(-20px, 20px) rotate(240deg); }
            100% { transform: translate(0, 0) rotate(360deg); }
        }

        /* Container Utama - SOLID WHITE untuk kontras maksimal */
        #app-container {
            width: 100%;
            max-width: 900px;
            height: 100%;
            max-height: 800px;
            background: #ffffff; /* Putih Solid */
            border-radius: 35px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.15), inset 0 0 0 2px rgba(255,255,255,0.5);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
            z-index: 10;
            border: 8px solid #eee;
        }

        /* Header */
        header {
            background: linear-gradient(90deg, var(--secondary), #3db3ab);
            padding: 15px;
            text-align: center;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            z-index: 20;
            border-radius: 0 0 25px 25px;
            margin: 0 20px;
        }

        h1 {
            margin: 0;
            font-size: 1.5rem;
            color: white;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            flex-grow: 1;
            text-align: center;
            letter-spacing: 1px;
        }

        .home-btn {
            background: white;
            color: var(--primary);
            border: none;
            padding: 10px 20px;
            border-radius: 30px;
            font-family: inherit;
            font-weight: 900;
            cursor: pointer;
            box-shadow: 0 5px 0 #ddd;
            transition: transform 0.1s;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .home-btn:active { transform: translateY(4px); box-shadow: none; }

        /* Layar */
        .screen {
            display: none;
            flex: 1;
            padding: 20px;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            overflow-y: auto;
            position: relative;
        }
        .screen.active { display: flex; animation: zoomIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes zoomIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

        /* MENU GRID */
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            width: 100%;
            max-width: 700px;
            margin-top: 30px;
        }
        
        @media (max-width: 600px) {
            .menu-grid { grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 20px;} 
        }

        .menu-card {
            background: white;
            border: none;
            border-radius: 25px;
            padding: 25px 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
            position: relative;
            overflow: hidden;
            border-bottom: 6px solid var(--secondary);
        }

        .menu-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.3) 100%);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .menu-card:hover {
            transform: translateY(-8px) scale(1.03);
            box-shadow: 0 15px 25px rgba(0,0,0,0.1);
            border-bottom-color: var(--primary);
        }
        
        .menu-card:hover::before { opacity: 1; }
        .menu-card:active { transform: translateY(2px) scale(0.98); }

        .menu-icon { font-size: 4rem; margin-bottom: 10px; display: block; filter: drop-shadow(0 5px 5px rgba(0,0,0,0.1)); transition: transform 0.3s;}
        .menu-card:hover .menu-icon { transform: scale(1.1) rotate(-5deg); }
        
        .menu-title { font-size: 1.2rem; font-weight: 800; color: var(--dark); line-height: 1.3; position: relative; z-index: 2; }

        /* STYLE HURUF (UMUM) */
        .letter-display {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            width: 100%;
            justify-content: center;
            perspective: 1000px;
        }

        .letter-box {
            background: white;
            border: none;
            border-radius: 25px;
            width: 120px;
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5rem;
            font-weight: 900;
            color: var(--secondary);
            box-shadow: 0 10px 0 rgba(0,0,0,0.1), 0 5px 15px rgba(78, 205, 196, 0.2);
            transition: transform 0.4s;
            cursor: pointer;
            transform-style: preserve-3d;
        }
        .letter-box.kecil { color: var(--primary); box-shadow: 0 10px 0 rgba(0,0,0,0.1), 0 5px 15px rgba(255, 107, 107, 0.2); }
        
        .letter-box:active { transform: scale(0.9); }
        
        /* Khususus Arab */
        .letter-box.arabic {
            width: 200px;
            height: 200px;
            font-size: 8rem;
            font-family: var(--font-arabic);
            color: #8e44ad; /* Ungu */
            box-shadow: 0 15px 0 rgba(0,0,0,0.1), 0 10px 20px rgba(142, 68, 173, 0.3);
            background: linear-gradient(135deg, #fff 0%, #f3e5f5 100%);
        }
        
        /* Perbaikan Kotak Gambar (Menjadi Putih Solid) */
        .letter-image-container {
            width: 100%;
            height: 200px;
            background: #ffffff; /* Solid White */
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            /* Hapus bayangan dalam */
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: relative;
            border: 4px solid #eee;
        }
        
        .letter-image { 
            font-size: 9rem; /* Gambar diperbesar */
            filter: drop-shadow(0 5px 0 rgba(0,0,0,0.15)); 
            animation: bounceSoft 3s ease-in-out infinite; 
        }
        @keyframes bounceSoft { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }

        .word-label {
            font-size: 2rem;
            font-weight: 900;
            color: var(--dark);
            margin: 0 0 10px 0;
            background: white;
            padding: 10px 30px;
            border-radius: 50px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .image-name-label {
            font-size: 1.5rem;
            color: #8e44ad;
            margin-bottom: 30px;
            font-weight: bold;
            background: #f3e5f5;
            padding: 5px 25px;
            border-radius: 30px;
            font-family: var(--font-arabic);
            direction: rtl;
            box-shadow: 0 4px 10px rgba(142, 68, 173, 0.1);
            animation: fadeIn 0.5s;
        }

        /* --- STYLE MEMBACA (EJAAN) --- */
        .flashcard { 
            width: 100%; 
            max-width: 500px; 
            background: white; 
            border: none;
            border-radius: 35px; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            box-shadow: 0 20px 0 rgba(0,0,0,0.05), 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px; 
            padding: 30px;
            background: linear-gradient(to bottom, #ffffff 0%, #fff5f5 100%);
            position: relative;
        }
        
        .flashcard::before {
            content: '';
            position: absolute;
            top: 15px; right: 15px;
            width: 40px; height: 40px;
            background: var(--accent);
            border-radius: 50%;
            opacity: 0.5;
        }

        .flashcard-img { 
            font-size: 9rem; 
            margin-bottom: 20px; 
            animation: bounceSoft 2s infinite; 
            filter: drop-shadow(0 5px 0 rgba(0,0,0,0.2)); 
        }
        
        .spelling-container {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
            width: 100%;
        }

        .spelling-letter {
            background: white;
            border: 4px solid var(--accent);
            color: var(--dark);
            width: 55px;
            height: 65px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.2rem;
            font-weight: 900;
            border-radius: 15px;
            box-shadow: 0 6px 0 var(--accent);
            text-transform: uppercase;
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) backwards;
        }
        
        /* --- STYLE MENULIS --- */
        .writing-prompt {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: var(--primary);
            font-weight: 800;
            background: white;
            padding: 5px 20px;
            border-radius: 20px;
            box-shadow: 0 3px 0 rgba(0,0,0,0.1);
        }
        
        .writing-target-display {
            font-size: 5rem;
            color: var(--secondary);
            margin-bottom: 20px;
            font-weight: 900;
            background: white;
            padding: 10px 40px;
            border-radius: 25px;
            border: 6px dashed var(--secondary);
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.05);
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
        }

        /* PERBAIKAN: KOTAK MENULIS DIKECILKAN (SQUARE BOX) */
        .canvas-container { 
            border: 6px dashed var(--dark); 
            border-radius: 30px; 
            background: white; 
            cursor: crosshair; 
            margin-bottom: 20px; 
            box-shadow: inset 0 0 30px rgba(0,0,0,0.05); 
            touch-action: none; 
            position: relative; 
            overflow: hidden;
            
            /* Ukuran Tetap Kotak agar mirip kolom diatasnya */
            width: 320px;
            height: 320px;
            
            /* Agar responsif di layar sangat kecil */
            max-width: 90vw;
            max-height: 90vw;
            
            flex-shrink: 0; /* Jangan biarkan menyusut */
        }

        .writing-controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            width: 100%;
            margin-top: auto;
            padding-top: 20px;
        }

        /* MATH (Visual Perbaikan) */
        .math-visual-area { display: flex; align-items: center; justify-content: center; gap: 20px; margin: 30px 0; flex-wrap: wrap; }
        
        .cloud { 
            background: white; 
            border: 5px solid #eef; 
            border-radius: 50px; 
            width: 160px; 
            min-height: 140px;
            position: relative; 
            display: flex; 
            flex-wrap: wrap; 
            align-content: center; 
            justify-content: center; 
            gap: 8px; 
            padding: 10px; 
            box-shadow: 0 5px 20px rgba(0,0,0,0.05); 
            animation: cloudFloat 6s ease-in-out infinite;
        }
        @keyframes cloudFloat { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        .math-operator { font-size: 4rem; font-weight: 900; color: var(--primary); text-shadow: 3px 3px 0px rgba(0,0,0,0.1); }
        
        .candy { 
            font-size: 2.5rem; 
            line-height: 1; 
            display: inline-block; 
            animation: popIn 0.3s ease; 
            filter: drop-shadow(2px 2px 0 rgba(0,0,0,0.2)); 
            flex-shrink: 0; 
        }

        .nav-btn { 
            background: white; 
            color: var(--secondary); 
            border: 3px solid var(--secondary); 
            padding: 15px 35px; 
            font-size: 1.2rem; 
            border-radius: 50px; 
            cursor: pointer; 
            box-shadow: 0 8px 0 #c4eae; 
            font-family: inherit; 
            font-weight: 900; 
            transition: all 0.2s;
        }
        .nav-btn:hover { background: var(--secondary); color: white; transform: translateY(-3px); }
        .nav-btn:active { transform: translateY(4px); box-shadow: none; }

        .toolbar { display: flex; gap: 12px; flex-wrap: wrap; justify-content: center; background: rgba(255,255,255,0.6); padding: 12px; border-radius: 20px; margin-bottom: 15px; width: 100%; }
        .color-btn { width: 40px; height: 40px; border-radius: 50%; border: 3px solid rgba(0,0,0,0.1); cursor: pointer; transition: transform 0.2s; box-shadow: 0 3px 5px rgba(0,0,0,0.1); }
        .color-btn:hover { transform: scale(1.1); }
        .color-btn.active { transform: scale(1.2); border-color: var(--dark); box-shadow: 0 0 0 2px white, 0 0 0 4px var(--dark); }
        .tool-btn { padding: 10px 20px; border-radius: 20px; border: none; cursor: pointer; font-family: inherit; font-weight: 800; background: var(--primary); color: white; box-shadow: 0 5px 0 #c94545; font-size: 1rem; transition: transform 0.1s; }
        .tool-btn:active { transform: translateY(4px); box-shadow: none; }

        .numpad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; max-width: 320px; margin: 0 auto; }
        .num-btn { background: white; border: 4px solid var(--accent); font-size: 1.8rem; padding: 15px; border-radius: 20px; cursor: pointer; font-family: inherit; color: var(--dark); box-shadow: 0 6px 0 #e6cf55; font-weight: 800; transition: transform 0.1s; }
        .num-btn:hover { background: #fffbe6; }
        .num-btn:active { transform: translateY(5px); box-shadow: none; }

        .answer-display { font-size: 3rem; height: 60px; border-bottom: 6px solid var(--dark); margin-bottom: 25px; width: 180px; margin-left: auto; margin-right: auto; display: flex; align-items: center; justify-content: center; color: var(--primary); background: white; border-radius: 15px 15px 0 0; font-weight: 900; }

        /* MODAL */
        #feedback-modal { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); display: none; justify-content: center; align-items: center; z-index: 100; }
        .modal-content { background: white; padding: 40px; border-radius: 40px; text-align: center; animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); border: 8px solid white; box-shadow: 0 20px 50px rgba(0,0,0,0.2); max-width: 90%; }
        @keyframes popIn { from { transform: scale(0) rotate(-10deg); } to { transform: scale(1) rotate(0); } }
        .modal-icon { font-size: 6rem; display: block; margin-bottom: 20px; animation: bounceSoft 1s infinite; }
        .modal-text { font-size: 1.8rem; font-weight: 900; margin-bottom: 30px; color: var(--dark); }
        
        .confetti { position: absolute; width: 15px; height: 15px; animation: fall linear forwards; z-index: 50; pointer-events: none; }
        @keyframes fall { to { transform: translateY(800px) rotate(720deg); } }
        .score-board { font-size: 1.5rem; color: var(--secondary); margin-bottom: 10px; font-weight: 900; background: white; padding: 5px 20px; border-radius: 50px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
    </style>
</head>
<body>

<!-- Background Shapes -->
<div class="bg-shape shape-1"></div>
<div class="bg-shape shape-2"></div>
<div class="bg-shape shape-3"></div>

<div id="app-container">
    <header>
        <button class="home-btn" onclick="goHome()">üè† <br>Menu</button>
        <h1 id="page-title">Ayo Belajar!</h1>
        <div style="width: 70px;"></div> 
    </header>

    <!-- MENU UTAMA -->
    <div id="screen-home" class="screen active">
        <h2 style="color: var(--primary); margin-top: 20px; font-size: 2rem; text-shadow: 2px 2px 0px rgba(0,0,0,0.1);">Pilih Pelajaran:</h2>
        <div class="menu-grid">
            <div class="menu-card" onclick="showScreen('alphabet')">
                <span class="menu-icon">üáÆüá©</span>
                <div class="menu-title">Abjad<br>(Indo)</div>
            </div>
            <div class="menu-card" onclick="showScreen('english')">
                <span class="menu-icon">üá¨üáß</span>
                <div class="menu-title">Alphabet<br>(English)</div>
            </div>
            <div class="menu-card" onclick="showScreen('arabic')">
                <span class="menu-icon">üïå</span>
                <div class="menu-title">Hijaiyah<br>(Arab)</div>
            </div>
            <div class="menu-card" onclick="showScreen('reading')">
                <span class="menu-icon">üìñ</span>
                <div class="menu-title">Membaca<br>(Ejaan)</div>
            </div>
            <div class="menu-card" onclick="showScreen('math')">
                <span class="menu-icon">üî¢</span>
                <div class="menu-title">Berhitung<br>(Math)</div>
            </div>
            <div class="menu-card" onclick="showScreen('writing')">
                <span class="menu-icon">‚úèÔ∏è</span>
                <div class="menu-title">Menulis</div>
            </div>
        </div>
    </div>

    <!-- SCREEN ABJAD INDONESIA -->
    <div id="screen-alphabet" class="screen">
        <h2 style="color: var(--secondary); font-size: 2rem; text-shadow: 2px 2px 0px rgba(0,0,0,0.1);">Belajar Abjad</h2>
        <div class="letter-display">
            <div class="letter-box" id="indo-upper">A</div>
            <div class="letter-box kecil" id="indo-lower">a</div>
        </div>
        <div class="letter-image-container"><div class="letter-image" id="indo-img">üçé</div></div>
        <div class="word-label" id="indo-word">APEL</div>
        <div class="controls"><button class="nav-btn" onclick="prevIndo()">‚¨ÖÔ∏è</button><button class="nav-btn" onclick="nextIndo()">‚û°Ô∏è</button></div>
    </div>

    <!-- SCREEN ALPHABET INGGRIS -->
    <div id="screen-english" class="screen">
        <h2 style="color: var(--primary); font-size: 2rem; text-shadow: 2px 2px 0px rgba(0,0,0,0.1);">Learn Alphabet</h2>
        <div class="letter-display">
            <div class="letter-box" id="eng-upper">A</div>
            <div class="letter-box kecil" id="eng-lower">a</div>
        </div>
        <div class="letter-image-container"><div class="letter-image" id="eng-img">üçé</div></div>
        <div class="word-label" id="eng-word">APPLE</div>
        <div class="controls"><button class="nav-btn" onclick="prevEng()">‚¨ÖÔ∏è</button><button class="nav-btn" onclick="nextEng()">‚û°Ô∏è</button></div>
    </div>

    <!-- SCREEN HURUF HIJAIYAH -->
    <div id="screen-arabic" class="screen">
        <h2 style="color: #8e44ad; font-size: 2rem; text-shadow: 2px 2px 0px rgba(0,0,0,0.1);">Belajar Hijaiyah</h2>
        <div style="display: flex; justify-content: center; margin: 20px 0;">
            <div class="letter-box arabic" id="arab-char">ÿß</div>
        </div>
        <div class="letter-image-container"><div class="letter-image" id="arab-img">üê∞</div></div>
        <div class="word-label" id="arab-name">ALIF</div>
        <div class="image-name-label" id="arab-img-name">ÿ£Ÿéÿ±ŸíŸÜŸéÿ®</div>
        <div class="controls"><button class="nav-btn" onclick="prevArab()">‚¨ÖÔ∏è</button><button class="nav-btn" onclick="nextArab()">‚û°Ô∏è</button></div>
    </div>

    <!-- SCREEN MEMBACA -->
    <div id="screen-reading" class="screen">
        <h2 style="color: var(--primary); font-size: 2rem; text-shadow: 2px 2px 0px rgba(0,0,0,0.1);">Belajar Ejaan</h2>
        <div class="flashcard">
            <div class="flashcard-img" id="card-img">ü¶Å</div>
            <div class="spelling-container" id="spelling-container"></div>
        </div>
        <div class="controls"><button class="nav-btn" onclick="prevCard()">‚¨ÖÔ∏è</button><button class="nav-btn" onclick="nextCard()">‚û°Ô∏è</button></div>
    </div>

    <!-- SCREEN BERHITUNG -->
    <div id="screen-math" class="screen">
        <div class="score-board">Skor: <span id="score">0</span> ‚≠ê</div>
        <h2 style="color: var(--primary); font-size: 2rem; text-shadow: 2px 2px 0px rgba(0,0,0,0.1);">Hitunglah!</h2>
        <div class="math-visual-area">
            <div class="cloud" id="cloud-left"></div>
            <div class="math-operator" id="math-operator">+</div>
            <div class="cloud" id="cloud-right"></div>
            <div class="math-operator">=</div>
        </div>
        <div class="answer-display" id="math-answer">?</div>
        <div class="numpad">
            <button class="num-btn" onclick="inputNum(1)">1</button><button class="num-btn" onclick="inputNum(2)">2</button><button class="num-btn" onclick="inputNum(3)">3</button>
            <button class="num-btn" onclick="inputNum(4)">4</button><button class="num-btn" onclick="inputNum(5)">5</button><button class="num-btn" onclick="inputNum(6)">6</button>
            <button class="num-btn" onclick="inputNum(7)">7</button><button class="num-btn" onclick="inputNum(8)">8</button><button class="num-btn" onclick="inputNum(9)">9</button>
            <button class="num-btn" style="background: #ffeeba;" onclick="clearAnswer()">C</button>
            <button class="num-btn" onclick="inputNum(0)">0</button>
            <button class="num-btn" style="background: #d4edda; color: green; font-size: 1.2rem;" onclick="checkAnswer()">OK</button>
        </div>
    </div>

    <!-- SCREEN MENULIS -->
    <div id="screen-writing" class="screen">
        <h2 style="color: var(--primary); font-size: 2rem; text-shadow: 2px 2px 0px rgba(0,0,0,0.1);">Latihan Menulis</h2>
        
        <div class="writing-prompt">Silakan tulis:</div>
        <div class="writing-target-display" id="writing-target">A</div>

        <div class="toolbar">
            <div class="color-btn active" style="background: black;" onclick="setColor('black', this)"></div>
            <div class="color-btn" style="background: #FF6B6B;" onclick="setColor('#FF6B6B', this)"></div>
            <div class="color-btn" style="background: #4ECDC4;" onclick="setColor('#4ECDC4', this)"></div>
            <div class="color-btn" style="background: #FFE66D;" onclick="setColor('#FFE66D', this)"></div>
            <div class="color-btn" style="background: #1A535C;" onclick="setColor('#1A535C', this)"></div>
        </div>

        <!-- Area Kanvas (Canvas) -->
        <canvas id="drawing-board" class="canvas-container"></canvas>

        <div class="writing-controls">
            <button class="nav-btn" onclick="prevWritingTarget()">‚¨ÖÔ∏è</button>
            <button class="tool-btn" onclick="clearWritingCanvas()">üóëÔ∏è Hapus</button>
            <button class="nav-btn" onclick="nextWritingTarget()">‚û°Ô∏è</button>
        </div>
    </div>

    <!-- MODAL -->
    <div id="feedback-modal">
        <div class="modal-content">
            <span class="modal-icon" id="fb-icon">üéâ</span>
            <div class="modal-text" id="fb-text">Hebat!</div>
            <button class="nav-btn" onclick="closeFeedback()">Lanjut</button>
        </div>
</div>

<script>
    /* --- DATA BAHASA INDONESIA --- */
    const indoData = [
        { u: 'A', l: 'a', word: 'APEL', img: 'üçé' }, { u: 'B', l: 'b', word: 'BOLA', img: '‚öΩ' }, { u: 'C', l: 'c', word: 'CUMI', img: 'ü¶ë' },
        { u: 'D', l: 'd', word: 'DOMBA', img: 'üêë' }, { u: 'E', l: 'e', word: 'ELANG', img: 'ü¶Ö' }, { u: 'F', l: 'f', word: 'FOTO', img: 'üì∑' },
        { u: 'G', l: 'g', word: 'GAJAH', img: 'üêò' }, { u: 'H', l: 'h', word: 'HARI', img: 'üìÖ' }, { u: 'I', l: 'i', word: 'IKAN', img: 'üêü' },
        { u: 'J', l: 'j', word: 'JERUK', img: 'üçä' }, { u: 'K', l: 'k', word: 'KUCING', img: 'üê±' }, { u: 'L', l: 'l', word: 'LAMPU', img: 'üí°' },
        { u: 'M', l: 'm', word: 'MOBIL', img: 'üöó' }, { u: 'N', l: 'n', word: 'NANAS', img: 'üçç' }, { u: 'O', l: 'o', word: 'ORANG', img: 'üßç' },
        { u: 'P', l: 'p', word: 'PISANG', img: 'üçå' }, { u: 'Q', l: 'q', word: 'QUEEN', img: 'üëë' }, { u: 'R', l: 'r', word: 'ROBOT', img: 'ü§ñ' },
        { u: 'S', l: 's', word: 'SAPI', img: 'üêÑ' }, { u: 'T', l: 't', word: 'TOPI', img: 'üé©' }, { u: 'U', l: 'u', word: 'ULAR', img: 'üêç' },
        { u: 'V', l: 'v', word: 'VAS', img: 'üè∫' }, { u: 'W', l: 'w', word: 'WORTEL', img: 'ü•ï' }, { u: 'X', l: 'x', word: 'SINAR-X', img: '‚ò¢Ô∏è' },
        {u: 'Y', l: 'y', word: 'YOYO', img: 'ü™Ä' }, { u: 'Z', l: 'z', word: 'ZEBRA', img: 'ü¶ì' }
    ];

    /* --- DATA BAHASA INGGRIS --- */
    const engData = [
        { u: 'A', l: 'a', word: 'APPLE', img: 'üçé' }, { u: 'B', l: 'b', word: 'BALL', img: '‚öΩ' }, { u: 'C', l: 'c', word: 'CAR', img: 'üöó' },
        { u: 'D', l: 'd', word: 'DOG', img: 'üê∂' }, { u: 'E', l: 'e', word: 'EGG', img: 'ü•ö' }, { u: 'F', l: 'f', word: 'FISH', img: 'üêü' },
        { u: 'G', l: 'g', word: 'GRAPES', img: 'üçá' }, { u: 'H', l: 'h', word: 'HOUSE', img: 'üè†' }, { u: 'I', l: 'i', word: 'ICE CREAM', img: 'üç¶' },
        { u: 'J', l: 'j', word: 'JUICE', img: 'üßÉ' }, { u: 'K', l: 'k', word: 'KITE', img: 'ü™Å' }, { u: 'L', l: 'l', word: 'LION', img: 'ü¶Å' },
        { u: 'M', l: 'm', word: 'MOON', img: 'üåô' }, { u: 'N', l: 'n', word: 'NOSE', img: 'üëÉ' }, { u: 'O', l: 'o', word: 'ORANGE', img: 'üçä' },
        { u: 'P', l: 'p', word: 'PIG', img: 'üê∑' }, { u: 'Q', l: 'q', word: 'QUEEN', img: 'üëë' }, { u: 'R', l: 'r', word: 'ROBOT', img: 'ü§ñ' },
        { u: 'S', l: 's', word: 'SUN', img: '‚òÄÔ∏è' }, { u: 'T', l: 't', word: 'TREE', img: 'üå≥' }, { u: 'U', l: 'u', word: 'UMBRELLA', img: '‚òÇÔ∏è' },
        { u: 'V', l: 'v', word: 'VAN', img: 'üöê' }, { u: 'W', l: 'w', word: 'WHALE', img: 'üêã' }, { u: 'X', l: 'x', word: 'XYLOPHONE', img: 'üéπ' },
        { u: 'Y', l: 'y', word: 'YARN', img: 'üß∂' }, { u: 'Z', l: 'z', word: 'ZEBRA', img: 'ü¶ì' }
    ];

    /* --- DATA BAHASA ARAB --- */
    const arabicData = [
        { char: 'ÿß', name: 'ALIF', img: 'üê∞', imgName: 'ÿ£Ÿéÿ±ŸíŸÜŸéÿ®' }, 
        { char: 'ÿ®', name: 'BA', img: 'üè†', imgName: 'ÿ®ŸéŸäŸíÿ™' },
        { char: 'ÿ™', name: 'TA', img: 'üçÖ', imgName: 'ÿ∑ŸéŸÖŸéÿßÿ™ŸêŸÖ' }, 
        { char: 'ÿ´', name: 'TSA', img: 'üê¶', imgName: 'ÿ∑Ÿéÿßÿ¶Ÿêÿ±' }, 
        { char: 'ÿ¨', name: 'JIM', img: '‚õ∞Ô∏è', imgName: 'ÿ¨Ÿéÿ®ŸéŸÑ' }, 
        { char: 'ÿ≠', name: 'HA', img: 'üõÅ', imgName: 'ÿ≠ŸéŸÖŸëŸéÿßŸÖ' }, 
        { char: 'ÿÆ', name: 'KHO', img: 'üçû', imgName: 'ÿÆŸèÿ®Ÿíÿ≤' }, 
        { char: 'ÿØ', name: 'DAL', img: 'üêª', imgName: 'ÿØŸèÿ®Ÿë' }, 
        { char: 'ÿ∞', name: 'DZAL', img: 'ü™∞', imgName: 'ÿ∞Ÿèÿ®Ÿéÿßÿ®' }, 
        { char: 'ÿ±', name: 'RO', img: 'üë®', imgName: 'ÿ±Ÿéÿ¨ŸèŸÑ' }, 
        { char: 'ÿ≤', name: 'ZAI', img: 'üåπ', imgName: 'ÿ≤ŸéŸáŸíÿ±Ÿéÿ©' }, 
        { char: 'ÿ≥', name: 'SIN', img: 'üêü', imgName: 'ÿ≥ŸéŸÖŸéŸÉŸéÿ©' }, 
        { char: 'ÿ¥', name: 'SYIN', img: '‚òÄÔ∏è', imgName: 'ÿ¥ŸéŸÖŸíÿ≥' }, 
        { char: 'ÿµ', name: 'SHOD', img: 'üåæ', imgName: 'ÿ¥ŸéÿπŸêŸäÿ±' }, 
        { char: 'ÿ∂', name: 'DHOD', img: 'üçÉ', imgName: 'ÿ∂ŸéŸÅŸíÿπŸéÿ©' }, 
        { char: 'ÿ∑', name: 'THO', img: 'üêÇ', imgName: 'ÿ´ŸéŸàŸíÿ±' }, 
        { char: 'ÿ∏', name: 'ZHO', img: 'üåë', imgName: 'ÿ∏ŸèŸÑŸíŸÖŸéÿ©' }, 
        { char: 'ÿπ', name: 'AIN', img: 'üëÅÔ∏è', imgName: 'ÿπŸéŸäŸíŸÜ' }, 
        { char: 'ÿ∫', name: 'GHAIN', img: 'ü¶≠', imgName: 'ÿ∫ŸéŸÑŸéÿ®' }, 
        { char: 'ŸÅ', name: 'FA', img: 'üêò', imgName: 'ŸÅŸêŸäŸÑ' }, 
        { char: 'ŸÇ', name: 'QOF', img: 'üêí', imgName: 'ŸÇŸêÿ±ŸíÿØ' }, 
        { char: 'ŸÉ', name: 'KAF', img: 'üìö', imgName: 'ŸÉŸêÿ™Ÿéÿßÿ®' }, 
        { char: 'ŸÑ', name: 'LAM', img: 'üåô', imgName: 'ŸÑŸéŸäŸíŸÑŸéÿ©' }, 
        { char: 'ŸÖ', name: 'MIM', img: 'üïå', imgName: 'ŸÖŸéÿ≥Ÿíÿ¨ŸêÿØ' }, 
        { char: 'ŸÜ', name: 'NUN', img: '‚≠ê', imgName: 'ŸÜŸéÿ¨ŸíŸÖ' }, 
        { char: 'Ÿà', name: 'WAWU', img: 'ü§©', imgName: 'ŸàŸéÿ¨ŸíŸá' }, 
        { char: 'Ÿá', name: 'HA', img: '‚ù§Ô∏è', imgName: 'ÿ≠Ÿèÿ®Ÿë' }, 
        { char: 'ÿ°', name: 'HAMZAH', img: 'ü§î', imgName: 'ÿ•Ÿêÿ∞Ÿéÿß' }, 
        { char: 'Ÿä', name: 'YA', img: 'üåº', imgName: 'ŸäŸéÿßÿ≥ŸíŸÖŸêŸäŸÜ' }
    ];

    /* --- DATA MEMBACA --- */
    const cards = [
        { word: "BEBEK", img: "ü¶Ü" }, { word: "GAJAH", img: "üêò" }, { word: "IKAN", img: "üêü" },
        { word: "KELINCI", img: "üê∞" }, { word: "LEMARI", img: "üö™" }, { word: "MOBIL", img: "üöó" },
        { word: "NANAS", img: "üçç" }, { word: "PISANG", img: "üçå" }, { word: "ROBOT", img: "ü§ñ" },
        { word: "ULAR", img: "üêç" }, { word: "WORTEL", img: "ü•ï" }, { word: "YOYO", img: "ü™Ä" }
    ];

    /* --- DATA MENULIS --- */
    const writingTargets = [
        ..."ABCDEFGHIJKLMNOPQRSTUVWXYZ".split('').map(c => ({ char: c, type: 'Huruf' })),
        ..."0123456789".split('').map(c => ({ char: c, type: 'Angka' }))
    ];

    /* --- LOGIKA UTAMA --- */
    let indices = { indo: 0, eng: 0, arab: 0, card: 0, writing: 0 };
    let mathState = { answer: 0, input: "", score: 0 };
    const candyEmojis = ["üç¨", "üç≠", "üç´", "üç©", "üç™", "üçé", "üçä", "üçá"];

    function showScreen(name) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(`screen-${name}`).classList.add('active');
        
        const titles = { 
            'home': 'Ayo Belajar!', 
            'alphabet': 'Abjad (Indo)', 
            'english': 'Alphabet (Eng)', 
            'arabic': 'Hijaiyah', 
            'reading': 'Membaca', 
            'math': 'Berhitung', 
            'writing': 'Menulis' 
        };
        document.getElementById('page-title').innerText = titles[name];
        
        if(name === 'writing') {
            // Delay sedikit agar layout selesai render sebelum inisialisasi kanvas
            setTimeout(() => {
                initCanvas();
                updateWritingTarget();
            }, 50);
        }
        if(name === 'math') generateMath();
    }

    function goHome() { showScreen('home'); }

    /* --- UPDATE FUNCTIONS --- */
    function updateIndo() {
        const d = indoData[indices.indo];
        document.getElementById('indo-upper').innerText = d.u;
        document.getElementById('indo-lower').innerText = d.l;
        document.getElementById('indo-img').innerText = d.img;
        document.getElementById('indo-word').innerText = d.word;
    }
    function nextIndo() { indices.indo = (indices.indo + 1) % indoData.length; updateIndo(); }
    function prevIndo() { indices.indo = (indices.indo - 1 + indoData.length) % indoData.length; updateIndo(); }

    function updateEng() {
        const d = engData[indices.eng];
        document.getElementById('eng-upper').innerText = d.u;
        document.getElementById('eng-lower').innerText = d.l;
        document.getElementById('eng-img').innerText = d.img;
        document.getElementById('eng-word').innerText = d.word;
    }
    function nextEng() { indices.eng = (indices.eng + 1) % engData.length; updateEng(); }
    function prevEng() { indices.eng = (indices.eng - 1 + engData.length) % engData.length; updateEng(); }

    function updateArab() {
        const d = arabicData[indices.arab];
        document.getElementById('arab-char').innerText = d.char;
        document.getElementById('arab-img').innerText = d.img;
        document.getElementById('arab-name').innerText = d.name;
        document.getElementById('arab-img-name').innerText = d.imgName;
    }
    function nextArab() { indices.arab = (indices.arab + 1) % arabicData.length; updateArab(); }
    function prevArab() { indices.arab = (indices.arab - 1 + arabicData.length) % arabicData.length; updateArab(); }

    function updateCard() {
        const data = cards[indices.card];
        document.getElementById('card-img').innerText = data.img;
        const imgEl = document.getElementById('card-img');
        imgEl.style.animation = 'none';
        imgEl.offsetHeight; 
        imgEl.style.animation = 'bounceSoft 2s infinite';

        const container = document.getElementById('spelling-container');
        container.innerHTML = '';
        const letters = data.word.split('');
        letters.forEach((letter, index) => {
            const box = document.createElement('div');
            box.className = 'spelling-letter';
            box.innerText = letter;
            box.style.animationDelay = `${index * 0.1}s`;
            container.appendChild(box);
        });
    }
    function nextCard() { indices.card = (indices.card + 1) % cards.length; updateCard(); }
    function prevCard() { indices.card = (indices.card - 1 + cards.length) % cards.length; updateCard(); }

    /* --- LOGIKA MENULIS --- */
    function updateWritingTarget() {
        const target = writingTargets[indices.writing];
        const display = document.getElementById('writing-target');
        display.innerText = target.char;
        clearWritingCanvas(); // Auto clear saat ganti huruf
        display.style.animation = 'none';
        display.offsetHeight;
        display.style.animation = 'bounceSoft 0.5s';
    }

    function nextWritingTarget() {
        indices.writing = (indices.writing + 1) % writingTargets.length;
        updateWritingTarget();
    }

    function prevWritingTarget() {
        indices.writing = (indices.writing - 1 + writingTargets.length) % writingTargets.length;
        updateWritingTarget();
    }

    function clearWritingCanvas() {
        clearCanvas(); 
    }

    /* --- MATH LOGIC (SUDAH DIPERBAIKI) --- */
    function generateMath() {
        document.getElementById('cloud-left').innerHTML = ''; 
        document.getElementById('cloud-right').innerHTML = '';
        mathState.input = ""; 
        document.getElementById('math-answer').innerText = "?";
        
        // Generate angka pertama (1-5)
        let n1 = Math.floor(Math.random() * 5) + 1; 
        
        // Tentukan operator (+ atau -)
        let op = Math.random() > 0.5 ? '+' : '-';
        
        // Generate angka kedua (1-5)
        let n2 = Math.floor(Math.random() * 5) + 1; 
        
        // Jika pengurangan, pastikan hasilnya tidak negatif (tukar posisi jika perlu)
        if (op === '-' && n1 < n2) { 
            [n1, n2] = [n2, n1]; 
        }
        
        mathState.answer = op === '+' ? n1 + n2 : n1 - n2;
        document.getElementById('math-operator').innerText = op;
        
        // Isi awan dengan gambar (emoji)
        fillCloud('cloud-left', n1); 
        fillCloud('cloud-right', n2);
    }

    function fillCloud(id, count) {
        const container = document.getElementById(id);
        // Pilih emoji acak untuk soal ini
        const emoji = candyEmojis[Math.floor(Math.random() * candyEmojis.length)];
        for(let i=0; i<count; i++) {
            const el = document.createElement('span'); 
            el.className = 'candy'; 
            el.innerText = emoji; 
            container.appendChild(el);
        }
    }

    function inputNum(n) {
        if (mathState.input.length < 2) { mathState.input += n; document.getElementById('math-answer').innerText = mathState.input; }
    }
    function clearAnswer() { mathState.input = ""; document.getElementById('math-answer').innerText = "?"; }
    function checkAnswer() {
        if (mathState.input === "") return;
        const modal = document.getElementById('feedback-modal');
        if (parseInt(mathState.input) === mathState.answer) {
            mathState.score += 10; document.getElementById('score').innerText = mathState.score;
            document.getElementById('fb-icon').innerText = "üéâ"; document.getElementById('fb-text').innerText = "Benar!"; createConfetti();
        } else {
            document.getElementById('fb-icon').innerText = "ü•∫"; document.getElementById('fb-text').innerText = `Jawabannya ${mathState.answer}`;
        }
        modal.style.display = 'flex';
    }
    function closeFeedback() { document.getElementById('feedback-modal').style.display = 'none'; generateMath(); }

    /* --- CANVAS LOGIC --- */
    const canvas = document.getElementById('drawing-board');
    const ctx = canvas.getContext('2d');
    let isDrawing = false;
    let brushColor = 'black';

    function initCanvas() {
    // 1. Ambil ukuran sebenarnya yang terlihat di layar (sesuai CSS)
    const rect = canvas.getBoundingClientRect();
    
    // 2. Set ukuran "internal" kanvas sama persis dengan ukuran tampilan
    // Jika rect.width gagal diambil (misal 0), gunakan 320 sebagai cadangan
    canvas.width = rect.width || 320; 
    canvas.height = rect.height || 320;
    
    // 3. Reset setting drawing (karena reset ukuran kanvas mereset setting gambar)
    ctx.lineJoin = 'round'; 
    ctx.lineCap = 'round'; 
    ctx.lineWidth = 10; 
    ctx.strokeStyle = brushColor;
}

    function getPos(e) {
        const rect = canvas.getBoundingClientRect();
        const clientX = e.touches ? e.touches[0].clientX : e.clientX;
        const clientY = e.touches ? e.touches[0].clientY : e.clientY;
        return { x: clientX - rect.left, y: clientY - rect.top };
    }

    function startDrawing(e) { isDrawing = true; const p = getPos(e); ctx.beginPath(); ctx.moveTo(p.x, p.y); e.preventDefault(); }
    function draw(e) {
        if (!isDrawing) return;
        const p = getPos(e);
        ctx.strokeStyle = brushColor; ctx.lineTo(p.x, p.y); ctx.stroke(); ctx.beginPath(); ctx.moveTo(p.x, p.y); e.preventDefault();
    }
    function stopDrawing() { isDrawing = false; }

    canvas.addEventListener('mousedown', startDrawing); canvas.addEventListener('mousemove', draw); canvas.addEventListener('mouseup', stopDrawing);
    canvas.addEventListener('touchstart', startDrawing, {passive: false}); canvas.addEventListener('touchmove', draw, {passive: false}); canvas.addEventListener('touchend', stopDrawing);

    function setColor(c, b) { brushColor = c; document.querySelectorAll('.color-btn').forEach(x => x.classList.remove('active')); b.classList.add('active'); }
    function clearCanvas() { 
        ctx.clearRect(0, 0, canvas.width, canvas.height); 
    }

    function createConfetti() {
        const colors = ['#FF6B6B', '#4ECDC4', '#FFE66D', '#FF9F1C', '#2EC4B6', '#FF007A'];
        const container = document.getElementById('app-container');
        for (let i = 0; i < 60; i++) {
            const conf = document.createElement('div'); conf.classList.add('confetti');
            conf.style.left = Math.random() * 100 + '%'; conf.style.top = '-20px';
            conf.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            conf.style.animationDuration = (Math.random() * 3 + 2) + 's';
            conf.style.transform = `rotate(${Math.random() * 360}deg)`;
            container.appendChild(conf); setTimeout(() => conf.remove(), 5000);
        }
    }

    // Init
    updateIndo(); updateEng(); updateArab(); updateCard();
</script>
</body>
</html>